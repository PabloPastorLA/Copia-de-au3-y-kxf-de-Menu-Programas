SplashTextOn('Espera','Autoit corriendo ' & @crlf & 'Inst. MBAM',160,80,0,110)
;~ MsgBox(0,'',@AppDataCommonDir)
If FileExists('mb3-setup nuevo.exe') AND not FileExists (@ProgramFilesDir & '\Malwarebytes\Anti-Malware\mbam.exe')  Then

;~ 	While FileExists (@AppDataCommonDir & '\Malwarebytes\Malwarebytes Anti-Malware\rules.ref')
;~ 		FileDelete(@AppDataCommonDir & '\Malwarebytes\Malwarebytes Anti-Malware\rules.ref')
;~ 	WEnd
;~ 	while FileExists (@AppDataCommonDir & '\Malwarebytes\Malwarebytes Anti-Malware\Configuration\database.conf')
;~ 		FileDelete(@AppDataCommonDir & '\Malwarebytes\Malwarebytes Anti-Malware\Configuration\database.conf')
;~ 	WEnd

;~ 	FileCopy('rules.ref',@AppDataCommonDir & '\Malwarebytes\Malwarebytes Anti-Malware\rules.ref',9)
;~ 	FileCopy('database.conf',@AppDataCommonDir & '\Malwarebytes\Malwarebytes Anti-Malware\Configuration\database.conf',9)

	ShellExecuteWait('mb3-setup nuevo.exe', ' /silent /NORESTART')
	ProcessWaitClose('mb3-setup nuevo.exe')
	RegWrite("HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\MBAMService", "Start", "REG_DWORD", 4)

;~ MsgBox(0,'','')

;~ 	While FileExists (@AppDataCommonDir & '\Malwarebytes\Malwarebytes Anti-Malware\rules.ref')
;~ 	FileDelete(@AppDataCommonDir & '\Malwarebytes\Malwarebytes Anti-Malware\rules.ref')
;~ 	WEnd
;~ 	while FileExists (@AppDataCommonDir & '\Malwarebytes\Malwarebytes Anti-Malware\Configuration\database.conf')
;~ 	FileDelete(@AppDataCommonDir & '\Malwarebytes\Malwarebytes Anti-Malware\Configuration\database.conf')
;~ 	WEnd

;~ 	FileCopy('rules.ref',@AppDataCommonDir & '\Malwarebytes\Malwarebytes Anti-Malware\rules.ref',9)
;~ 	FileCopy('database.conf',@AppDataCommonDir & '\Malwarebytes\Malwarebytes Anti-Malware\Configuration\database.conf',9)




	FileWrite(@DesktopDir & "\Bien Instalado.txt","Mbam"&@CRLF)
else
	FileWrite(@DesktopDir & "\Mal Instalado.txt","Mbam"&@CRLF)
EndIf







#cs run(@ProgramFilesDir & "\TuneUp Utilities 2008\Integrator.exe")
WinWaitActive("TuneUp Utilities 2008: Interfaz de inicio")
ControlClick("Necesita reiniciar el programa", "Aceptar", "Button1")
#ce


;ProcessClose ( "UnlockerAssistant.exe" )
;If $title = "Mozilla Firefox Setup " And $TextLine[8] = "C:\Program Files\Mozilla Firefox\" Or                  ;32bit
;   $title = "Mozilla Firefox Setup " And $TextLine[8] = "C:\Program Files(x86)\Mozilla Firefox\" Then      ;64bit
;Something I do when it's correct
;ElseIf $title = "Mozilla Firefox Setup " And $TextLine[8] = $ProgramFiles & "FireFox\" Then
;Something I do when it's not correct
;Else
;It didn't find what it's supposed to
;EndIf


;run("Unlocker1-9-2.exe")
;WinWaitActive("Installer Language")
;send("{enter}")
;WinWaitActive("Instalación de Unlocker 1.9.2")
;send(" {!s} ")
;WinWaitActive("Instalación de Unlocker 1.9.2","A. Unlocker End User License Agreement")
;WinActivate("Instalación de Unlocker 1.9.2","A. Unlocker End User License Agreement")
;send("{ALTDOWN}{c}{ALTUP}")
;WinWaitActive("Instalación de Unlocker 1.9.2", "Delta Toolbar")
;ControlClick("Instalación de Unlocker 1.9.2", "Advanced", "Button9")
;ControlClick("Instalación de Unlocker 1.9.2", "Install Delta toolbar", "Button5")
;ControlClick("Instalación de Unlocker 1.9.2", "&Siguiente >", "Button2")
;WinWaitActive("Instalación de Unlocker 1.9.2", "Elegir lugar de instalación")
;ControlClick("Instalación de Unlocker 1.9.2", "&Siguiente >", "Button2")

;WinWaitActive("Instalación de Unlocker 1.9.2", "Selección de componentes")
;ControlClick("Instalación de Unlocker 1.9.2", "&Instalar", "Button2")

;WinWaitActive("Instalación de Unlocker 1.9.2", "Unlocker 1.9.2 ha sido instalad")
;ControlClick("Instalación de Unlocker 1.9.2", "&Terminar", "Button2")
;WinWaitClose("Instalación de Unlocker 1.9.2")
;ALT – [!a]
;WinWaitActive("Iniciar sesión - Google Chrome","Iniciar sesión")
;send("{tab}{tab}{tab}{tab}{tab}{space}")
;Sleep(5000)


